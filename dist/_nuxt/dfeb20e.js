(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{284:function(e,t,n){var content=n(292);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(62).default)("5a2e470a",content,!0,{sourceMap:!1})},291:function(e,t,n){"use strict";n(284)},292:function(e,t,n){var o=n(61)(!1);o.push([e.i,"*[data-v-3785ca64],[data-v-3785ca64]:after,[data-v-3785ca64]:before{box-sizing:border-box}ol[class][data-v-3785ca64],ul[class][data-v-3785ca64]{padding:0}blockquote[data-v-3785ca64],body[data-v-3785ca64],dd[data-v-3785ca64],dl[data-v-3785ca64],figcaption[data-v-3785ca64],figure[data-v-3785ca64],h1[data-v-3785ca64],h2[data-v-3785ca64],h3[data-v-3785ca64],h4[data-v-3785ca64],li[data-v-3785ca64],ol[class][data-v-3785ca64],p[data-v-3785ca64],ul[class][data-v-3785ca64]{margin:0}html[data-v-3785ca64]{scroll-behavior:smooth}body[data-v-3785ca64]{min-height:100vh;text-rendering:optimizeSpeed;line-height:1.5}ol[class][data-v-3785ca64],ul[class][data-v-3785ca64]{list-style:none}a[data-v-3785ca64]:not([class]){-webkit-text-decoration-skip:ink;text-decoration-skip-ink:auto}img[data-v-3785ca64]{max-width:100%;display:block}article>*+*[data-v-3785ca64]{margin-top:1em}button[data-v-3785ca64],input[data-v-3785ca64],select[data-v-3785ca64],textarea[data-v-3785ca64]{font:inherit}input[data-v-3785ca64],textarea[data-v-3785ca64]{outline:none}@media (prefers-reduced-motion:reduce){*[data-v-3785ca64]{-webkit-animation-duration:.01ms!important;animation-duration:.01ms!important;-webkit-animation-iteration-count:1!important;animation-iteration-count:1!important;transition-duration:.01ms!important;scroll-behavior:auto!important}}input[data-v-3785ca64]::-webkit-inner-spin-button,input[data-v-3785ca64]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number][data-v-3785ca64]{-moz-appearance:textfield}.guest[data-v-3785ca64]{width:100%;height:100%}.guest__actions[data-v-3785ca64]{margin-bottom:20px;align-items:center}.guest__actions[data-v-3785ca64],.guest__items[data-v-3785ca64]{display:grid;grid-template-columns:repeat(4,1fr);grid-gap:30px}.guest__item[data-v-3785ca64]{width:100%;height:150px;box-shadow:0 4px 9px 0 #cacaca;display:grid;grid-template-columns:1fr;grid-gap:20px;align-items:center;padding:20px;cursor:pointer}.guest__text_green[data-v-3785ca64]{color:green}.guest__text_red[data-v-3785ca64]{color:red}.info[data-v-3785ca64]{width:100%}.info__actions[data-v-3785ca64]{display:flex;justify-content:space-between;align-items:center;margin:20px 0}.info__items[data-v-3785ca64]{display:grid;grid-template-columns:1fr;grid-gap:20px}.info__body[data-v-3785ca64]{padding:10px}",""]),e.exports=o},305:function(e,t,n){"use strict";n.r(t);var o=n(17),c=(n(46),n(2),{name:"Guest",data:function(){return{guests:[],rooms:[],tabIndex:0,selectedGuest:null,model:{profile:{fio:"",passportDetails:"",placeOfRegistration:"",phone:""},invoice:{additionalServices:[],dailyServices:{breakfast:!1,cleaning:!1,dinner:!1,lunch:!1}},rooms:{current:null,number:null,days:null}}}},computed:{formattedRoomsList:function(){var e=[];return this.rooms.forEach((function(t){0===t.data.status&&e.push({text:t.data.number,value:t.id,id:t.id})})),e},formattedGuestsList:function(){var e=[];return this.guests.forEach((function(t){e.push({text:t.data.profile.fio,value:t.id,id:t.id,profile:t.data.profile})})),e}},watch:{tabIndex:{immediate:!0,handler:function(e){e&&this.reset()}},selectedGuest:{immediate:!0,handler:function(){var e=this;this.formattedGuestsList.forEach((function(t){e.selectedGuest===t.id&&(e.model.profile=t.profile)}))}}},created:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getGuestsList();case 2:return t.next=4,e.getRoomsList();case 4:case"end":return t.stop()}}),t)})))()},methods:{reset:function(){this.selectedGuest=null,this.model={profile:{fio:"",passportDetails:"",placeOfRegistration:"",phone:""},invoice:{additionalServices:[],dailyServices:{breakfast:!1,cleaning:!1,dinner:!1,lunch:!1}},rooms:{current:null,number:null}}},getGuestsList:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$fire.firestore.collection("guest");case 2:n=t.sent;try{n.onSnapshot((function(t){var n=[];t.forEach((function(e){var t={id:e.id,data:e.data()};n.push(t)})),e.guests=JSON.parse(JSON.stringify(n))}))}catch(t){e.showToast(t,"Ошибка")}case 4:case"end":return t.stop()}}),t)})))()},getRoomsList:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$fire.firestore.collection("rooms");case 2:n=t.sent;try{n.onSnapshot((function(t){var n=[];t.forEach((function(e){var t={id:e.id,data:e.data()};n.push(t)})),e.rooms=JSON.parse(JSON.stringify(n))}))}catch(e){console.log(e)}case 4:case"end":return t.stop()}}),t)})))()},deleteGuest:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.$fire.firestore.collection("guest").doc(e);case 2:o=n.sent;try{o.delete()}catch(e){console.log(e),t.showToast(e.message,"Ошибка")}case 4:case"end":return n.stop()}}),n)})))()},addGuest:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$fire.firestore.collection("guest");case 2:return n=t.sent,o=null,e.formattedRoomsList.forEach((function(t){e.model.rooms.current===t.id&&(o=t.text)})),e.model.rooms.number=o,t.prev=6,t.next=9,n.add(e.model);case 9:return c=t.sent,t.next=12,e.bookingRoom(e.model.rooms.current,c.id);case 12:if(1!==e.tabIndex||!e.selectedGuest){t.next=15;break}return t.next=15,e.deleteGuest(e.selectedGuest);case 15:e.showToast("Запись успешно добавлена","Успех"),e.reset(),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(6),console.log(t.t0),e.showToast(t.t0.message,"Ошибка");case 23:case"end":return t.stop()}}),t,null,[[6,19]])})))()},bookingRoom:function(e,t){var n=this;return Object(o.a)(regeneratorRuntime.mark((function o(){var c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.$fire.firestore.collection("rooms").doc(e);case 2:c=o.sent;try{c.update({guestId:t,status:1}),n.showToast("Номер успешно забронирован","Успех")}catch(e){console.log(e),n.showToast(e.message,"Ошибка")}case 4:case"end":return o.stop()}}),o)})))()},showInfo:function(e){this.$router.push("/info/".concat(e.id))}}}),r=(n(291),n(63)),component=Object(r.a)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main"},[n("div",{staticClass:"guest"},[n("div",{staticClass:"guest__actions"},[n("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-add",modifiers:{"modal-add":!0}}],attrs:{variant:"outline-primary"}},[e._v("\n        Оформить договор\n      ")])],1),e._v(" "),n("div",{staticClass:"guest__items"},e._l(e.guests,(function(t,i){return n("div",{key:i,staticClass:"guest__item",on:{click:function(n){return e.showInfo(t)}}},[n("div",{staticClass:"guest__text"},[e._v("\n          ФИО: "+e._s(t.data.profile.fio)+"\n        ")]),e._v(" "),t.data.rooms.number?n("div",{staticClass:"guest__text"},[e._v("\n          Комната:\n          "),n("span",{staticClass:"guest__text guest__text_red"},[e._v("\n            "+e._s(t.data.rooms.number)+"\n          ")])]):e._e()])})),0)]),e._v(" "),n("b-modal",{attrs:{id:"modal-add",centered:"",title:"Оформление нового договора"},on:{ok:function(t){return e.addGuest()}}},[n("b-card",{attrs:{"no-body":""}},[n("b-tabs",{attrs:{card:"","content-class":"mt-3",fill:""},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}},[n("b-tab",{attrs:{"no-body":"",title:"Новый гость"}},[n("div",{staticClass:"info__body"},[n("div",{staticClass:"info__items"},[e._v("\n              Профиль\n              "),n("b-form-input",{attrs:{placeholder:"Введите ФИО"},model:{value:e.model.profile.fio,callback:function(t){e.$set(e.model.profile,"fio",t)},expression:"model.profile.fio"}}),e._v(" "),n("b-form-input",{attrs:{placeholder:"Введите телефон"},model:{value:e.model.profile.phone,callback:function(t){e.$set(e.model.profile,"phone",t)},expression:"model.profile.phone"}}),e._v(" "),n("b-form-input",{attrs:{placeholder:"Введите пасспотные данные (серия, номер)"},model:{value:e.model.profile.passportDetails,callback:function(t){e.$set(e.model.profile,"passportDetails",t)},expression:"model.profile.passportDetails"}}),e._v(" "),n("b-form-input",{attrs:{placeholder:"Введите данные места регистрации"},model:{value:e.model.profile.placeOfRegistration,callback:function(t){e.$set(e.model.profile,"placeOfRegistration",t)},expression:"model.profile.placeOfRegistration"}}),e._v(" "),n("div",[e._v("\n                Дневные сервисы:\n                "),n("b-form-checkbox",{staticClass:"mt-2",attrs:{id:"breakfast",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.breakfast,callback:function(t){e.$set(e.model.invoice.dailyServices,"breakfast",t)},expression:"model.invoice.dailyServices.breakfast"}},[e._v("\n                  Завтрак\n                ")]),e._v(" "),n("b-form-checkbox",{attrs:{id:"dinner",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.dinner,callback:function(t){e.$set(e.model.invoice.dailyServices,"dinner",t)},expression:"model.invoice.dailyServices.dinner"}},[e._v("\n                  Обед\n                ")]),e._v(" "),n("b-form-checkbox",{attrs:{id:"lunch",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.lunch,callback:function(t){e.$set(e.model.invoice.dailyServices,"lunch",t)},expression:"model.invoice.dailyServices.lunch"}},[e._v("\n                  Ужин\n                ")]),e._v(" "),n("b-form-checkbox",{attrs:{id:"cleaning",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.cleaning,callback:function(t){e.$set(e.model.invoice.dailyServices,"cleaning",t)},expression:"model.invoice.dailyServices.cleaning"}},[e._v("\n                  Уборка\n                ")])],1),e._v(" "),n("div",[e._v("\n                Выбор номера:\n                "),n("b-form-select",{staticClass:"mt-2",attrs:{options:e.formattedRoomsList},model:{value:e.model.rooms.current,callback:function(t){e.$set(e.model.rooms,"current",t)},expression:"model.rooms.current"}},[n("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("\n                    Выберите номер из списка\n                  ")])],1)],1),e._v(" "),n("b-form-input",{attrs:{placeholder:"Введите количество дней"},model:{value:e.model.rooms.days,callback:function(t){e.$set(e.model.rooms,"days",t)},expression:"model.rooms.days"}})],1)])]),e._v(" "),n("b-tab",{attrs:{"no-body":"",title:"Старый гость"}},[n("div",{staticClass:"info__body"},[n("div",{staticClass:"mb-4"},[e._v("\n              Выберите гостя:\n              "),n("b-form-select",{staticClass:"mt-2",attrs:{options:e.formattedGuestsList},model:{value:e.selectedGuest,callback:function(t){e.selectedGuest=t},expression:"selectedGuest"}},[n("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("\n                  Выберите гостя из списка\n                ")])],1)],1),e._v("\n            Дневные сервисы:\n            "),n("b-form-checkbox",{staticClass:"mt-2",attrs:{id:"breakfast",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.breakfast,callback:function(t){e.$set(e.model.invoice.dailyServices,"breakfast",t)},expression:"model.invoice.dailyServices.breakfast"}},[e._v("\n              Завтрак\n            ")]),e._v(" "),n("b-form-checkbox",{attrs:{id:"dinner",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.dinner,callback:function(t){e.$set(e.model.invoice.dailyServices,"dinner",t)},expression:"model.invoice.dailyServices.dinner"}},[e._v("\n              Обед\n            ")]),e._v(" "),n("b-form-checkbox",{attrs:{id:"lunch",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.lunch,callback:function(t){e.$set(e.model.invoice.dailyServices,"lunch",t)},expression:"model.invoice.dailyServices.lunch"}},[e._v("\n              Ужин\n            ")]),e._v(" "),n("b-form-checkbox",{attrs:{id:"cleaning",name:"checkbox-1",value:"accepted","unchecked-value":"not_accepted"},model:{value:e.model.invoice.dailyServices.cleaning,callback:function(t){e.$set(e.model.invoice.dailyServices,"cleaning",t)},expression:"model.invoice.dailyServices.cleaning"}},[e._v("\n              Уборка\n            ")]),e._v(" "),n("div",{staticClass:"mt-3"},[e._v("\n              Выбор номера:\n              "),n("b-form-select",{staticClass:"mt-2",attrs:{options:e.formattedRoomsList},model:{value:e.model.rooms.current,callback:function(t){e.$set(e.model.rooms,"current",t)},expression:"model.rooms.current"}},[n("b-form-select-option",{attrs:{value:null,disabled:""}},[e._v("\n                  Выберите номер из списка\n                ")])],1)],1),e._v(" "),n("b-form-input",{staticClass:"mt-3",attrs:{placeholder:"Введите количество дней"},model:{value:e.model.rooms.days,callback:function(t){e.$set(e.model.rooms,"days",t)},expression:"model.rooms.days"}})],1)])],1)],1)],1)],1)}),[],!1,null,"3785ca64",null);t.default=component.exports}}]);